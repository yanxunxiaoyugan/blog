## Spring调用本类方法代理失效解决办法

在使用spring框架的时候，我们经常会使用@transactional，@Cachable等注解，这些注解的功能在spring底层是使用Aop生成动态代理类去帮我们做的。也就是说只有走了代理类这些注解才会生效，通俗点来讲从Bean的外部去调用就会走代理类，那么这个时候这些注解都是有用的，但是如果在Bean的内部去调用带有这些注解的方法，就不会走代理类，所以这些注解就会失效。解决方案之一就是在Bean的内部强制使用代理类，如下：

> （（${Bean}）AopContext.currentProxy()）.${method
>
> 实际使用的时候，把${Bean}换成本类名，${method}换成实际调用的方法即可。
> 需要注意的是，原生的AspectJ是不会有这种自身调用的问题的，因为AspectJ本质是一个代码生成工具，它会在编译时修改源代码从而达到AOP的效果，所以它不是基于代理的AOP框架。

以上。